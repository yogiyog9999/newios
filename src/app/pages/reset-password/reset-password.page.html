<ion-content class="auth-content">
  <!-- Header with Logo -->
  <ion-header class="custom-header ion-no-border">
    <ion-toolbar>
      <ion-title class="header-title">
        <img src="assets/logo.png" alt="App Logo" class="logo-img" />
      </ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="auth-container main-container">

    <!-- Welcome Text -->
    <div class="welcome-text">
      <h2>Welcome To</h2>
      <h2 class="app-title">D List App</h2>
      <p class="subtitle">Reset your password below</p>
    </div>

    <ng-container [ngSwitch]="step">

      <!-- Step 1: Request reset email -->
      <form *ngSwitchCase="'request'" (ngSubmit)="sendReset()" class="reset-form">
        
        <!-- Email -->
        <ion-item class="input-item" lines="none">
          <ion-icon name="mail-outline" slot="start"></ion-icon>
          <ion-input 
            type="email" 
            [(ngModel)]="email" 
            name="email" 
            placeholder="Enter your email" 
            required>
          </ion-input>
        </ion-item>

        <!-- Send Reset Button -->
        <ion-button expand="block" type="submit" [disabled]="loading" class="login-btn">
          <ion-spinner *ngIf="loading" slot="start"></ion-spinner>
          {{ loading ? 'Sending…' : 'Send Reset Link' }}
        </ion-button>

        <!-- Messages -->
        <ion-text color="success" *ngIf="info" class="success-text">{{ info }}</ion-text>
        <ion-text color="danger" *ngIf="errorMsg" class="error-text">{{ errorMsg }}</ion-text>
      </form>

      <!-- Step 2: Update password -->
      <form *ngSwitchCase="'update'" (ngSubmit)="updatePassword()" class="reset-form">
        
        <!-- New Password -->
        <ion-item class="input-item" lines="none">
          <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
          <ion-input 
            [type]="showPassword ? 'text' : 'password'" 
            [(ngModel)]="newPassword" 
            name="newPassword" 
            placeholder="Enter new password" 
            minlength="6" 
            required>
          </ion-input>
          <!-- Toggle Eye Icon -->
          <ion-icon 
            [name]="showPassword ? 'eye-off-outline' : 'eye-outline'" 
            slot="end" 
            (click)="togglePasswordVisibility()">
          </ion-icon>
        </ion-item>

        <!-- Update Password Button -->
        <ion-button expand="block" type="submit" [disabled]="loading" class="login-btn">
          <ion-spinner *ngIf="loading" slot="start"></ion-spinner>
          {{ loading ? 'Saving…' : 'Update Password' }}
        </ion-button>

        <!-- Messages -->
        <ion-text color="success" *ngIf="info" class="success-text">{{ info }}</ion-text>
        <ion-text color="danger" *ngIf="errorMsg" class="error-text">{{ errorMsg }}</ion-text>
      </form>

    </ng-container>

    <!-- Privacy -->
    <p class="privacy-text">
      <a href="/auth/login">Back to Login</a>
    </p>
  </div>
</ion-content>
